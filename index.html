<html lang="it">
<head>
  <title>Raspberry Pi Surveillance</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- css di bootstrap4 -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>



    <script type="text/javascript">
    
    $(comandosx).onclick=function(){
     if(ws.readyState===ws.OPEN){
      ws.send("s");}
    }
    $(comandodx).onclick=function(){
      if(ws.readyState===ws.OPEN){
      ws.send("d");}
    }
    $(absoluteposition).onclick=function(){
      if(ws.readyState===ws.OPEN){
      ws.send($(coordinate).val);}
    }
    window.onload = function(){
      var ip=$(address).val;
      var ws=new WebSocket(ip);
      ws.binaryType = "arraybuffer";
      }
    ws.onopen= function(){
        console.log("Socket connected to "+ ip);
        ws.addEventListener("message";function(event){
          var img=new Blob([event.data],{type: "image/jpg"});
          var url=URL.createObjectURL(img);
          $(live).attr("src",url);
        });
    }

    ws.onclose= function(){
      console.log("Trying to reconnect socket...");
      var ws=new WebSocket(ip);
      ws.binaryType = "arraybuffer";
    }


      
      
  }
  </script>
 </head>
<body>

<div class="container-fluid" style="padding: 5%;height:90%;">

 <!-- SEZIONE IMMAGINI-->
  <div class="row" style="width:100%">
    <div class="col-12 col-sm-12 col-md-12" style="width: 960px; height:540px; background-color: #efefef;">
      <!-- contenitore per immagini live -->
      <img id="live" alt="livestreaming" src="stream/test.jpg" width="960px" height="540px" style="display:inline-block">
    </div>
  </div>

  <!-- SEZIONE COMANDI -->
  <div class="row" style="padding-top: 1%; width:100%">
    <div class="col-12 col-sm-12 col-md-12" style="position:sticky;">
      <table align="center">
        <tr><td align="center">
         <form name="control-form" method="post">
            <div class="form-group">
              <input id="comandosx" type="submit" class="btn-inline" name="comandi" value="SX (45°)">
              <input id="comandodx" type="submit" class="btn-inline" name="comandi" value="DX (45°)">
            </div>
            <div class="form-group">
              <input id="coordinate" type="number" name="position" class="form-control-inline" min="0" max="359">
              <input id="absoluteposition" type="submit" name="sendposition" value="INVIA" class="btn-inline">
            </div>
          </form>
        </td></tr>
      </table>
    </div>
  </div>

</div>

<!--
<footer align="center" style="text-align:center;color: grey;">
    <label>Coded by: </label>
    <a href="https://github.com/Mattens15">Matteo Attenni</a>
    &
    <a href="https://github.com/rsoul" >Raoul Nuccetelli</a>
    &
    <a href="https://github.com/djzapo" >Mihai Alexandru Zapodeanu</a>
</footer>
-->
</body>
</html>
